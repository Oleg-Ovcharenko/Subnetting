function IPinformation(){this.ipAddress=[],this.mask=0,this.ipBinary,this.maskBinary,this.wildcardBinary,this.networkBinary,this.hostminBinary,this.hostmaxBinary,this.broadcastBinary}function subnetConstant(){this.ip,this.ipNwtwork,this.mask,this.maskBinary=[],this.subnetNumber,this.subnetNumberBinary=[],this.newIpSubnets,this.newDecemalMask,this.newBinaryMask,this.newMaskDecemalFull,this.sizeNewSubnet,this.rangeMinAddress=[],this.rangeMaxAddress=[]}var toBinary=function(t){for(var i=[],a=0;a<t.length;a++)if(i[a]=Number(t[a]).toString(2),i[a].length<8){for(var n="0",e=1;e<8-i[a].length;e++)n+="0";i[a]=n+i[a]}return i},toHexadecimal=function(t){for(var i,a=[],n=[],e=0;e<t.length;e++)n[e]=parseInt(t[e],2),a[e]=Number(n[e]).toString(16),a[e].length<2&&(a[e]="0"+a[e]);return i=a.join(".").toUpperCase()},validIP=function(t){var i=/^(25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[0-9]{2}|[0-9])(\.(25[0-5]|2[0-4][0-9]|[0-1][0-9]{2}|[0-9]{2}|[0-9])){3}$/;if(0==i.test(t))throw alert("Введен не коректный ip-адресс. Пожалуйста проверьте правильность ввода."),new SyntaxError("Введен не коректный ip-адресс.")},validMask=function(t){var i=/^(1|2|3|4|5|6|7|8|9|10|11|12|13|14|15|16|17|18|19|20|21|22|23|24|25|26|27|28|29|30|31|32)$/;if(0==i.test(t))throw alert("Введено некореткное значение маски подсети."),new SyntaxError("Введен не коректный ip-адресс.")},outputFormatBinary=function(t,i){var a,n=t.join("").split("");n.splice(8,0,"."),n.splice(17,0,"."),n.splice(26,0,"."),8>=i&&n.splice(i,0," | "),i>8&&16>=i&&n.splice(i+1,0," | "),i>16&&24>=i&&n.splice(i+2,0," | "),i>24&&31>=i&&n.splice(i+3,0," | ");var e=$.inArray(" | ",n);return"."==n[e-1]&&n.splice(e-1,1),"."==n[e+1]&&n.splice(e+1,1),a=n.join("")},binaryToDecemal=function(t){for(var i,a=[],n=0;n<t.length;n++)a[n]=parseInt(t[n],2);return i=a.join(".")},dotFormat=function(t){var i=t;return i.splice(8,0,"."),i.splice(17,0,"."),i.splice(26,0,"."),i=i.join("").split(".")},compareArr=function(t){for(var i,a=0;a<t.length;a++)if(1==Number(t[a])&&(i=!0),0==Number(t[a]))return i=!1;return!0};IPinformation.prototype.getIp=function(){var t=$("#ip_analiz").val();0!=validIP(t)&&(this.ipAddress=t.split("."))},IPinformation.prototype.getMask=function(){var t=$("#mask_analiz").val();return 0==validMask(t)?!1:void(this.mask=Number(t))},IPinformation.prototype.outIp=function(){this.ipBinary=toBinary(this.ipAddress),$("#address_decimal").text(binaryToDecemal(this.ipBinary)),$("#address_hexadecimal").text(toHexadecimal(this.ipBinary)),$("#address_binary").text(outputFormatBinary(this.ipBinary,this.mask))},IPinformation.prototype.outMask=function(){$("#mask_decimal").text(this.mask);for(var t=[],i=0;i<this.mask;i++)t[i]=1;for(var a=this.mask;32>a;a++)t[a]=0;this.maskBinary=dotFormat(t);var n=outputFormatBinary(this.maskBinary,this.mask);$("#mask_binary").text(n)},IPinformation.prototype.outNetmask=function(){$("#netmask_decemal").text(binaryToDecemal(this.maskBinary)),$("#netmask_hexadecimal").text(toHexadecimal(this.maskBinary)),$("#netmask_binary").text(outputFormatBinary(this.maskBinary,this.mask))},IPinformation.prototype.outWildcard=function(){for(var t=this.maskBinary.join("").split(""),i=0;i<t.length;i++)1==Number(t[i])?t[i]=0:t[i]=1;this.wildcardBinary=dotFormat(t),$("#wildcard_decemal").text(binaryToDecemal(this.wildcardBinary)),$("#wildcard_hexadecimal").text(toHexadecimal(this.wildcardBinary)),$("#wildcard_binary").text(outputFormatBinary(this.wildcardBinary,this.mask))},IPinformation.prototype.outNetwork=function(){var t=[];ip=this.ipBinary.join("").split(""),mask=this.maskBinary.join("").split("");for(var i=0;i<mask.length;i++)1==Number(mask[i])?t[i]=ip[i]:t[i]=0;this.networkBinary=dotFormat(t),$("#network_decemal").text(binaryToDecemal(this.networkBinary)),$("#network_hexadecimal").text(toHexadecimal(this.wildcardBinary)),$("#network_binary").text(outputFormatBinary(this.networkBinary,this.mask))},IPinformation.prototype.outHostMin=function(){var t=this.networkBinary[3];t=parseInt(t,2),t+=1,t=t.toString(2);var i="0";if(t.length<8){for(var a=1;a<8-t.length;a++)i+="0";t=i+t}this.hostminBinary=this.networkBinary,this.hostminBinary[3]=t,$("#hostmin_decemal").text(binaryToDecemal(this.hostminBinary)),$("#hostmin_hexadecimal").text(toHexadecimal(this.hostminBinary)),$("#hostmin_binary").text(outputFormatBinary(this.hostminBinary,this.mask))},IPinformation.prototype.outHostMax=function(){for(var t=this.ipBinary.join("").split(""),i=this.maskBinary.join("").split(""),a=0;a<i.length;a++)1!=i[a]&&0==i[a]&&(t[a]="1");t[31]=0,this.hostmaxBinary=dotFormat(t),$("#hostmax_decemal").text(binaryToDecemal(this.hostmaxBinary)),$("#hostmax_hexademical").text(toHexadecimal(this.hostmaxBinary)),$("#hostmax_binary").text(outputFormatBinary(this.hostmaxBinary,this.mask))},IPinformation.prototype.outBroadcast=function(){for(var t=this.ipBinary.join("").split(""),i=this.maskBinary.join("").split(""),a=0;a<i.length;a++)1!=i[a]&&0==i[a]&&(t[a]="1");this.broadcastBinary=dotFormat(t),$("#broadcast_decemal").text(binaryToDecemal(this.broadcastBinary)),$("#broadcast_hexademical").text(toHexadecimal(this.broadcastBinary)),$("#broadcast_binary").text(outputFormatBinary(this.broadcastBinary,this.mask))},IPinformation.prototype.outHosts=function(){for(var t=this.maskBinary.join("").split(""),i=0,a=0;a<t.length;a++)0==t[a]&&i++,1!=t[a];i=Math.pow(2,i)-2,$("#hosts_decemal").text(i)},$(function(){var t=new IPinformation;$("#ip_analiz_btn").click(function(){try{t.getIp(),t.getMask()}catch(i){return void console.log(i)}t.outIp(),t.outMask(),t.outNetmask(),t.outWildcard(),t.outNetwork(),t.outHostMin(),t.outHostMax(),t.outBroadcast(),t.outHosts()})}),subnetConstant.prototype.getIpConstatnt=function(){var t=$("#ip_subnet_constant").val();0!=validIP(t)&&(this.ip=t.split("."))},subnetConstant.prototype.getMaskConstatnt=function(){var t=$("#mask_subnet_constant").val();if(0==validMask(t))return!1;this.mask=Number(t);for(var i=0;32>i;i++)i<this.mask?this.maskBinary[i]="1":this.maskBinary[i]="0"},subnetConstant.prototype.getSubnetNumber=function(){var t=/^\d+$/,i=$("#amount_constant").val();if(0==t.test(i))throw alert("Введено некореткное значение количества подсетей."),new SyntaxError("Введено некореткное значение количества подсетей.");this.subnetNumber=Number(i),this.subnetNumberBinary=this.subnetNumber.toString(2)},subnetConstant.prototype.subnetConstant=function(){var t=this.subnetNumberBinary.length,i=this.maskBinary,a=this.subnetNumberBinary.length+this.mask,n=this.ip;if(this.newDecemalMask=a,a>32)throw alert("Разбиение не возможно"),new Error("Разбиение не возможно");for(var e=0;t>e;e++)i.splice(0,0,"1");i.splice(i.length-t,t),i=dotFormat(i),this.newBinaryMask=i,this.mask>0&&this.mask<=8&&(n[1]=0,n[2]=0,n[3]=0),this.mask>=9&&this.mask<=16&&(n[2]=0,n[3]=0),this.mask>=17&&this.mask<=24&&(n[3]=0),this.ipNwtwork=n.join(".");var s;a>0&&8>=a&&(s=0),a>=9&&16>=a&&(s=1),a>=17&&24>=a&&(s=2),a>=25&&32>=a&&(s=3);for(var r=i[s].split(""),o=0,e=0;e<r.length;e++)1==Number(r[e])&&o++;8==a||16==a||24==a?(r=128,this.sizeNewSubnet=r,s++):(r.splice(0,o),r.splice(0,0,"1"),r=r.join(""),r=parseInt(r,2),this.sizeNewSubnet=r),2==this.subnetNumber&&(r=128,this.sizeNewSubnet=r);var m=[];m[0]=n.join(".");for(var h=0;h<this.subnetNumber-1;h++)if(3==s&&r+n[s]<254)n[s]=r+Number(n[s]),m[h+1]=n.join(".");else{if(3==s&&r+n[s]>=254)if(Number(n[s-1])+1<254)n[s-1]=Number(n[s-1])+1,n[s]=0;else if(Number(n[s-2])+1<254)n[s-2]=Number(n[s-2])+1,n[s-1]=0;else{if(!(Number(n[s-3])+1<254))throw new Error("Разбиение не возможно");n[s-3]=Number(n[s-3])+1,n[s-2]=0}if(2==s&&r+Number(n[s])<254)n[s]=r+Number(n[s]),m[h+1]=n.join(".");else{if(2==s&&r+Number(n[s])>=254)if(Number(n[s-1])+1<254)n[s-1]=Number(n[s-1])+1,n[s]=0;else{if(!(Number(n[s-2])+1<254))throw new Error("Разбиение не возможно");n[s-2]=Number(n[s-2])+1,n[s-1]=0}if(1==s&&r+Number(n[s])<254)n[s]=r+Number(n[s]),m[h+1]=n.join(".");else{if(1==s&&r+Number(n[s])>=254){if(!(Number(n[s-1])+1<254))throw new Error("Разбиение не возможно");n[s-1]=Number(n[s-1])+1,n[s]=0}if(0==s&&r+Number(n[s])<254)n[s]=r+Number(n[s]),m[h+1]=n.join(".");else{if(0==s&&r+Number(n[s])>=254&&Number(n[s])>254)throw new Error("Разбиение не возможно");m[h+1]=n.join(".")}}}}this.newIpSubnets=m;for(var h=0;h<this.subnetNumber;h++){var u=this.newIpSubnets[h].split("."),l=this.newIpSubnets[h].split(".");3==s&&(u[3]=Number(u[3])+1,this.rangeMinAddress[h]=u.join("."),l[3]=Number(l[3])+r-2,this.rangeMaxAddress[h]=l.join(".")),2==s&&(u[3]=1,this.rangeMinAddress[h]=u.join("."),l[3]=254,l[2]=Number(l[2])+r-1,this.rangeMaxAddress[h]=l.join(".")),1==s&&(u[3]=1,this.rangeMinAddress[h]=u.join("."),l[3]=255,l[2]=254,l[1]=Number(l[1])+r-1,this.rangeMaxAddress[h]=l.join(".")),0==s&&(u[3]=1,this.rangeMinAddress[h]=u.join("."),l[3]=255,l[2]=255,l[1]=254,this.rangeMaxAddress[h]=l.join("."))}},subnetConstant.prototype.outTable=function(){this.newMaskDecemalFull=binaryToDecemal(this.newBinaryMask);for(var t=this.newBinaryMask.join("").split(""),i=0,a=0;a<t.length;a++)0==t[a]&&i++,1!=t[a];i=Math.pow(2,i)-2,this.allocatedSize=i;for(var a=0;a<this.newIpSubnets.length;a++)$("#table_constatnt").append("<tr><td>"+(a+1)+"</td><td>"+this.allocatedSize+"</td><td>"+this.newIpSubnets[a]+"</td><td>/"+this.newDecemalMask+"</td><td>"+this.newMaskDecemalFull+"</td><td>"+this.rangeMinAddress[a]+" - "+this.rangeMaxAddress[a]+"</td></tr>")},subnetConstant.prototype.wildcard=function(){for(var t=this.newBinaryMask.join("").split(""),i=0;i<t.length;i++)1==Number(t[i])?t[i]=0:t[i]=1;return t=dotFormat(t),t=binaryToDecemal(t)},subnetConstant.prototype.outInformation=function(){$("#info_netw").append("Исходная сеть: <b>"+this.ipNwtwork+" / "+this.mask+"</b>"),$("#info_chosts").append("Количество доступных хостов в каждой подсети: <b>"+this.allocatedSize+"</b>"),$("#info_newmask").append("Новая маска: <b>"+this.newMaskDecemalFull+"</b> или <b>"+this.newDecemalMask+"</b>"),$("#info_wildcar").append("Обратная маска: <b>"+this.wildcard()+"</b>")},$(function(){var t=new subnetConstant;$("#calculate_subneting_consstant_btn").click(function(){try{t.getIpConstatnt(),t.getMaskConstatnt(),t.getSubnetNumber(),t.subnetConstant(),t.outTable(),t.outInformation(),$(".indicator_subnet_constant").text("Разбиение выполнено успешно").removeClass("text-danger").addClass("text-success").show()}catch(i){return console.log(i),void $(".indicator_subnet_constant").text("Разбиение невозможно").removeClass("text-success").addClass("text-danger").show()}})});